# 비즈니스 요구사항 정의서

## 1. 스테이크홀더 요구사항

| 스테이크홀더 | 주요 요구사항 |
|-------------|------------|
| **고객** | 실시간 재고 확인, 빠른 주문 처리, 쿠폰 할인 혜택, 포인트 사용 |
| **비즈니스 오너** | 인기 상품 통계, 재고 관리 최적화, 안정적인 주문 처리, 쿠폰 마케팅 |
| **개발팀** | 동시성 제어, 확장 가능한 아키텍처, 외부 연동 안정성 |
| **운영팀** | 시스템 모니터링, 외부 연동 실패 추적, 빠른 장애 대응 |

---

## 2. 기능적 요구사항

### 2.1 상품 관리
- 상품 정보 조회 (가격, 재고)
- 실시간 재고 확인
- 인기 상품 통계 (최근 3일, Top 5)

### 2.2 주문/결제 시스템
- 장바구니 CRUD
- 주문 시 재고 확인 및 차감
- 포인트 기반 결제
- 쿠폰 할인 적용 (선택)

### 2.3 쿠폰 시스템
- 선착순 발급 (한정 수량, 동시성 제어)
- 쿠폰 유효성 검증 (사용 여부, 만료 여부)
- 쿠폰 사용 이력 관리

### 2.4 포인트 시스템
- 포인트 잔액 조회
- 포인트 충전/사용
- 포인트 거래 내역 조회

### 2.5 데이터 연동
- 주문 완료 시 외부 시스템 데이터 전송
- 전송 실패 시에도 주문은 정상 처리

---

## 3. 비기능적 요구사항

### 3.1 성능
- 상품 조회: 500ms 이내
- 주문 처리: 2초 이내
- 동시 주문: 최소 100 TPS

### 3.2 가용성
- 외부 시스템 장애 시에도 주문 처리 유지

### 3.3 확장성
- API 서버 수평 확장 가능

### 3.4 데이터 정합성
- 쿠폰 발급 및 재고 차감 동시성 제어
- 결제 트랜잭션 보장

---

## 4. 비즈니스 규칙 및 제약사항

### 4.1 비즈니스 규칙

#### 상품/주문
- 재고 0인 상품 주문 불가
- 주문 수량만큼 재고 즉시 차감
- 주문 완료 후 장바구니 상품 삭제

#### 결제
- 포인트 잔액 부족 시 결제 불가
- 주문 상품당 쿠폰 1개만 사용 가능
- 최종 금액 = 상품 총액 - 쿠폰 할인

#### 쿠폰
- 동일 쿠폰 1인 1개만 발급
- 만료/사용된 쿠폰 사용 불가
- 만료일시 = 발급일시 + 유효일수

#### 포인트
- 포인트는 음수 불가
- 모든 변동 내역 기록

### 4.2 기술적 제약사항
- Java 21, Spring Boot 3.x
- MySQL 8.0 이상
- 모든 금액은 BIGINT (원 단위)
- 외부 연동: 트랜잭션 분리